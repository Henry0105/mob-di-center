#!/bin/bash
set -x -e

if [ $# -lt 1 ]; then
    echo "Please input param: day"
    exit 1
fi
source /home/dba/mobdi_center/conf/hive-env.sh

day=$1
p7=$(date -d "$day -7 days" "+%Y%m%d")
day=${day}_muid

tmpdb=$dm_mobdi_tmp
gender_feature_v2_part1="${tmpdb}.gender_feature_v2_part1"
gender_feature_v2_part2="${tmpdb}.gender_feature_v2_part2"
gender_feature_v2_part3="${tmpdb}.gender_feature_v2_part3"
gender_feature_v2_part4="${tmpdb}.gender_feature_v2_part4"
gender_feature_v2_part5="${tmpdb}.gender_feature_v2_part5"
gender_feature_v2_part6="${tmpdb}.gender_feature_v2_part6"
gender_feature_v2_part7="${tmpdb}.gender_feature_v2_part7"
gender_feature_v2_part8="${tmpdb}.gender_feature_v2_part8"
gender_feature_v2_part9="${tmpdb}.gender_feature_v2_part9"
gender_feature_v2_part13="${tmpdb}.gender_feature_v2_part13"
gender_feature_v2_part14="${tmpdb}.gender_feature_v2_part14"
gender_feature_v2_part15="${tmpdb}.gender_feature_v2_part15"
gender_feature_v2_part16="${tmpdb}.gender_feature_v2_part16"
gender_feature_v2_part17="${tmpdb}.gender_feature_v2_part17"
gender_feature_v2_part18="${tmpdb}.gender_feature_v2_part18"
gender_feature_v2_part19="${tmpdb}.gender_feature_v2_part19"

gender_feature_v2_final="${tmpdb}.gender_feature_v2_final"

hive -e "
set mapred.max.split.size=256000000;
set mapred.min.split.size.per.node=100000000;
set mapred.min.split.size.per.rack=100000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.smallfiles.avgsize=256000000;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.exec.max.dynamic.partitions.pernode=1000;
set hive.exec.max.dynamic.partitions=10000;

insert overwrite table $gender_feature_v2_final partition(day='$day')
select t1.device, 
case when cnt_cate_l1_index15 is null or cnt_cate_l1_index15=-99 then 3.0 else cnt_cate_l1_index15 end as cnt_cate_l1_index15,
case when cnt_cate_l1_index8 is null or cnt_cate_l1_index8=-99 then 0.0 else cnt_cate_l1_index8 end as cnt_cate_l1_index8,
case when cnt_cate_l1_index19 is null or cnt_cate_l1_index19=-99 then 0.0 else cnt_cate_l1_index19 end as cnt_cate_l1_index19,
case when cnt_cate_l1_index18 is null or cnt_cate_l1_index18=-99 then 0.0 else cnt_cate_l1_index18 end as cnt_cate_l1_index18,
case when cnt_cate_l1_index12 is null or cnt_cate_l1_index12=-99 then 2.0 else cnt_cate_l1_index12 end as cnt_cate_l1_index12,
case when cnt_cate_l1_index13 is null or cnt_cate_l1_index13=-99 then 1.0 else cnt_cate_l1_index13 end as cnt_cate_l1_index13,
case when cnt_cate_l1_index5 is null or cnt_cate_l1_index5=-99 then 7.0 else cnt_cate_l1_index5 end as cnt_cate_l1_index5,
case when cnt_cate_l1_index16 is null or cnt_cate_l1_index16=-99 then 1.0 else cnt_cate_l1_index16 end as cnt_cate_l1_index16,
case when cnt_cate_l2_index102 is null or cnt_cate_l2_index102=-99 then 1.0 else cnt_cate_l2_index102 end as cnt_cate_l2_index102,
case when cnt_cate_l2_index91 is null or cnt_cate_l2_index91=-99 then 0.0 else cnt_cate_l2_index91 end as cnt_cate_l2_index91,
case when cnt_cate_l2_index10 is null or cnt_cate_l2_index10=-99 then 0.0 else cnt_cate_l2_index10 end as cnt_cate_l2_index10,
case when cnt_cate_l2_index165 is null or cnt_cate_l2_index165=-99 then 0.0 else cnt_cate_l2_index165 end as cnt_cate_l2_index165,
case when cnt_cate_l2_index214 is null or cnt_cate_l2_index214=-99 then 0.0 else cnt_cate_l2_index214 end as cnt_cate_l2_index214,
case when cnt_cate_l2_index124 is null or cnt_cate_l2_index124=-99 then 0.0 else cnt_cate_l2_index124 end as cnt_cate_l2_index124,
case when cnt_cate_l2_index162 is null or cnt_cate_l2_index162=-99 then 0.0 else cnt_cate_l2_index162 end as cnt_cate_l2_index162,
case when cnt_cate_l2_index178 is null or cnt_cate_l2_index178=-99 then 0.0 else cnt_cate_l2_index178 end as cnt_cate_l2_index178,
case when cnt_cate_l2_index140 is null or cnt_cate_l2_index140=-99 then 0.0 else cnt_cate_l2_index140 end as cnt_cate_l2_index140,
case when cnt_cate_l2_index4 is null or cnt_cate_l2_index4=-99 then 0.0 else cnt_cate_l2_index4 end as cnt_cate_l2_index4,
case when cnt_cate_l2_index196 is null or cnt_cate_l2_index196=-99 then 0.0 else cnt_cate_l2_index196 end as cnt_cate_l2_index196,
case when cnt_cate_l2_index209 is null or cnt_cate_l2_index209=-99 then 0.0 else cnt_cate_l2_index209 end as cnt_cate_l2_index209,
case when cnt_cate_l2_index96 is null or cnt_cate_l2_index96=-99 then 0.0 else cnt_cate_l2_index96 end as cnt_cate_l2_index96,
case when cnt_cate_l2_index158 is null or cnt_cate_l2_index158=-99 then 0.0 else cnt_cate_l2_index158 end as cnt_cate_l2_index158,
case when cnt_cate_l2_index41 is null or cnt_cate_l2_index41=-99 then 2.0 else cnt_cate_l2_index41 end as cnt_cate_l2_index41,
case when cnt_cate_l2_index14 is null or cnt_cate_l2_index14=-99 then 3.0 else cnt_cate_l2_index14 end as cnt_cate_l2_index14,
case when cnt_cate_l2_index20 is null or cnt_cate_l2_index20=-99 then 0.0 else cnt_cate_l2_index20 end as cnt_cate_l2_index20,
case when cnt_cate_l2_index188 is null or cnt_cate_l2_index188=-99 then 0.0 else cnt_cate_l2_index188 end as cnt_cate_l2_index188,
case when cnt_cate_l2_index86 is null or cnt_cate_l2_index86=-99 then 0.0 else cnt_cate_l2_index86 end as cnt_cate_l2_index86,
case when cnt_cate_l2_index92 is null or cnt_cate_l2_index92=-99 then 0.0 else cnt_cate_l2_index92 end as cnt_cate_l2_index92,
case when cnt_cate_l2_index201 is null or cnt_cate_l2_index201=-99 then 0.0 else cnt_cate_l2_index201 end as cnt_cate_l2_index201,
case when cnt_cate_l2_index137 is null or cnt_cate_l2_index137=-99 then 0.0 else cnt_cate_l2_index137 end as cnt_cate_l2_index137,
case when rt_cate_l1_index19 is null or rt_cate_l1_index19=-99 then 0.015384615384615384 else rt_cate_l1_index19 end as rt_cate_l1_index19,
case when rt_cate_l1_index11 is null or rt_cate_l1_index11=-99 then 0.024390243902439025 else rt_cate_l1_index11 end as rt_cate_l1_index11,
case when rt_cate_l1_index18 is null or rt_cate_l1_index18=-99 then 0.0 else rt_cate_l1_index18 end as rt_cate_l1_index18,
case when rt_cate_l1_index12 is null or rt_cate_l1_index12=-99 then 0.040816326530612235 else rt_cate_l1_index12 end as rt_cate_l1_index12,
case when rt_cate_l1_index13 is null or rt_cate_l1_index13=-99 then 0.024390243902439025 else rt_cate_l1_index13 end as rt_cate_l1_index13,
case when rt_cate_l1_index5 is null or rt_cate_l1_index5=-99 then 0.11904761904761905 else rt_cate_l1_index5 end as rt_cate_l1_index5,
case when rt_cate_l2_index44 is null or rt_cate_l2_index44=-99 then 0.0 else rt_cate_l2_index44 end as rt_cate_l2_index44,
case when rt_cate_l2_index102 is null or rt_cate_l2_index102=-99 then 0.015384615384615384 else rt_cate_l2_index102 end as rt_cate_l2_index102,
case when rt_cate_l2_index42 is null or rt_cate_l2_index42=-99 then 0.0 else rt_cate_l2_index42 end as rt_cate_l2_index42,
case when rt_cate_l2_index156 is null or rt_cate_l2_index156=-99 then 0.0 else rt_cate_l2_index156 end as rt_cate_l2_index156,
case when rt_cate_l2_index7 is null or rt_cate_l2_index7=-99 then 0.0 else rt_cate_l2_index7 end as rt_cate_l2_index7,
case when rt_cate_l2_index57 is null or rt_cate_l2_index57=-99 then 0.015267175572519085 else rt_cate_l2_index57 end as rt_cate_l2_index57,
case when rt_cate_l2_index91 is null or rt_cate_l2_index91=-99 then 0.0 else rt_cate_l2_index91 end as rt_cate_l2_index91,
case when rt_cate_l2_index10 is null or rt_cate_l2_index10=-99 then 0.0 else rt_cate_l2_index10 end as rt_cate_l2_index10,
case when rt_cate_l2_index103 is null or rt_cate_l2_index103=-99 then 0.0 else rt_cate_l2_index103 end as rt_cate_l2_index103,
case when rt_cate_l2_index115 is null or rt_cate_l2_index115=-99 then 0.0 else rt_cate_l2_index115 end as rt_cate_l2_index115,
case when rt_cate_l2_index16 is null or rt_cate_l2_index16=-99 then 0.0 else rt_cate_l2_index16 end as rt_cate_l2_index16,
case when rt_cate_l2_index52 is null or rt_cate_l2_index52=-99 then 0.013157894736842105 else rt_cate_l2_index52 end as rt_cate_l2_index52,
case when rt_cate_l2_index6 is null or rt_cate_l2_index6=-99 then 0.014814814814814815 else rt_cate_l2_index6 end as rt_cate_l2_index6,
case when rt_cate_l2_index214 is null or rt_cate_l2_index214=-99 then 0.0 else rt_cate_l2_index214 end as rt_cate_l2_index214,
case when rt_cate_l2_index124 is null or rt_cate_l2_index124=-99 then 0.0 else rt_cate_l2_index124 end as rt_cate_l2_index124,
case when rt_cate_l2_index152 is null or rt_cate_l2_index152=-99 then 0.0 else rt_cate_l2_index152 end as rt_cate_l2_index152,
case when rt_cate_l2_index178 is null or rt_cate_l2_index178=-99 then 0.0 else rt_cate_l2_index178 end as rt_cate_l2_index178,
case when rt_cate_l2_index140 is null or rt_cate_l2_index140=-99 then 0.0 else rt_cate_l2_index140 end as rt_cate_l2_index140,
case when rt_cate_l2_index4 is null or rt_cate_l2_index4=-99 then 0.0 else rt_cate_l2_index4 end as rt_cate_l2_index4,
case when rt_cate_l2_index71 is null or rt_cate_l2_index71=-99 then 0.0 else rt_cate_l2_index71 end as rt_cate_l2_index71,
case when rt_cate_l2_index128 is null or rt_cate_l2_index128=-99 then 0.0 else rt_cate_l2_index128 end as rt_cate_l2_index128,
case when rt_cate_l2_index45 is null or rt_cate_l2_index45=-99 then 0.0 else rt_cate_l2_index45 end as rt_cate_l2_index45,
case when rt_cate_l2_index126 is null or rt_cate_l2_index126=-99 then 0.0 else rt_cate_l2_index126 end as rt_cate_l2_index126,
case when rt_cate_l2_index196 is null or rt_cate_l2_index196=-99 then 0.0 else rt_cate_l2_index196 end as rt_cate_l2_index196,
case when rt_cate_l2_index209 is null or rt_cate_l2_index209=-99 then 0.0 else rt_cate_l2_index209 end as rt_cate_l2_index209,
case when rt_cate_l2_index94 is null or rt_cate_l2_index94=-99 then 0.0 else rt_cate_l2_index94 end as rt_cate_l2_index94,
case when rt_cate_l2_index87 is null or rt_cate_l2_index87=-99 then 0.0 else rt_cate_l2_index87 end as rt_cate_l2_index87,
case when rt_cate_l2_index41 is null or rt_cate_l2_index41=-99 then 0.03773584905660377 else rt_cate_l2_index41 end as rt_cate_l2_index41,
case when rt_cate_l2_index88 is null or rt_cate_l2_index88=-99 then 0.0 else rt_cate_l2_index88 end as rt_cate_l2_index88,
case when rt_cate_l2_index14 is null or rt_cate_l2_index14=-99 then 0.04411764705882353 else rt_cate_l2_index14 end as rt_cate_l2_index14,
case when rt_cate_l2_index147 is null or rt_cate_l2_index147=-99 then 0.0 else rt_cate_l2_index147 end as rt_cate_l2_index147,
case when rt_cate_l2_index93 is null or rt_cate_l2_index93=-99 then 0.0 else rt_cate_l2_index93 end as rt_cate_l2_index93,
case when rt_cate_l2_index60 is null or rt_cate_l2_index60=-99 then 0.0 else rt_cate_l2_index60 end as rt_cate_l2_index60,
case when rt_cate_l2_index188 is null or rt_cate_l2_index188=-99 then 0.0 else rt_cate_l2_index188 end as rt_cate_l2_index188,
case when rt_cate_l2_index86 is null or rt_cate_l2_index86=-99 then 0.0 else rt_cate_l2_index86 end as rt_cate_l2_index86,
case when rt_cate_l2_index59 is null or rt_cate_l2_index59=-99 then 0.0 else rt_cate_l2_index59 end as rt_cate_l2_index59,
case when rt_cate_l2_index111 is null or rt_cate_l2_index111=-99 then 0.0 else rt_cate_l2_index111 end as rt_cate_l2_index111,
case when rt_cate_l2_index92 is null or rt_cate_l2_index92=-99 then 0.0 else rt_cate_l2_index92 end as rt_cate_l2_index92,
case when rt_cate_l2_index65 is null or rt_cate_l2_index65=-99 then 0.0 else rt_cate_l2_index65 end as rt_cate_l2_index65,
case when rt_cate_l2_index201 is null or rt_cate_l2_index201=-99 then 0.0 else rt_cate_l2_index201 end as rt_cate_l2_index201,
case when rt_cate_l2_index137 is null or rt_cate_l2_index137=-99 then 0.0 else rt_cate_l2_index137 end as rt_cate_l2_index137,
case when rt_cate_l2_index159 is null or rt_cate_l2_index159=-99 then 0.0 else rt_cate_l2_index159 end as rt_cate_l2_index159,
case when cnt_tgi5_tgi_male is null or cnt_tgi5_tgi_male=-99 then 7.0 else cnt_tgi5_tgi_male end as cnt_tgi5_tgi_male,
case when cnt_tgi5_tgi_female is null or cnt_tgi5_tgi_female=-99 then 2.0 else cnt_tgi5_tgi_female end as cnt_tgi5_tgi_female,
case when cnt_tgi5_tgi_female_high is null or cnt_tgi5_tgi_female_high=-99 then 2.0 else cnt_tgi5_tgi_female_high end as cnt_tgi5_tgi_female_high,
case when cnt_tgi5_tgi_male_high is null or cnt_tgi5_tgi_male_high=-99 then 5.0 else cnt_tgi5_tgi_male_high end as cnt_tgi5_tgi_male_high,
case when rt_tgi5_tgi_male is null or rt_tgi5_tgi_male=-99 then 0.13793103448275862 else rt_tgi5_tgi_male end as rt_tgi5_tgi_male,
case when rt_tgi5_tgi_female is null or rt_tgi5_tgi_female=-99 then 0.04395604395604396 else rt_tgi5_tgi_female end as rt_tgi5_tgi_female,
case when rt_tgi5_tgi_female_high is null or rt_tgi5_tgi_female_high=-99 then 0.05333333333333334 else rt_tgi5_tgi_female_high end as rt_tgi5_tgi_female_high,
case when rt_tgi5_tgi_male_high is null or rt_tgi5_tgi_male_high=-99 then 0.08333333333333333 else rt_tgi5_tgi_male_high end as rt_tgi5_tgi_male_high,
case when rt_tgi5_tgi_normal is null or rt_tgi5_tgi_normal=-99 then 0.3310344827586207 else rt_tgi5_tgi_normal end as rt_tgi5_tgi_normal,
case when rt_tgi_male_female is null or rt_tgi_male_female=-99 then 1.3333333333333333 else rt_tgi_male_female end as rt_tgi_male_female,
case when rt_avg_tgi is null or rt_avg_tgi=-99 then 0.953740718284484 else rt_avg_tgi end as rt_avg_tgi,
case when cnt_top_app56 is null or cnt_top_app56=-99 then 0.0 else cnt_top_app56 end as cnt_top_app56,
case when cnt_top_app81 is null or cnt_top_app81=-99 then 0.0 else cnt_top_app81 end as cnt_top_app81,
case when cnt_top_app121 is null or cnt_top_app121=-99 then 0.0 else cnt_top_app121 end as cnt_top_app121,
case when cnt_top_app187 is null or cnt_top_app187=-99 then 0.0 else cnt_top_app187 end as cnt_top_app187,
case when cnt_top_app247 is null or cnt_top_app247=-99 then 0.0 else cnt_top_app247 end as cnt_top_app247,
case when cnt_top_app287 is null or cnt_top_app287=-99 then 0.0 else cnt_top_app287 end as cnt_top_app287,
case when cnt_top_app180 is null or cnt_top_app180=-99 then 0.0 else cnt_top_app180 end as cnt_top_app180,
case when cnt_top_app33 is null or cnt_top_app33=-99 then 0.0 else cnt_top_app33 end as cnt_top_app33,
case when cnt_top_app38 is null or cnt_top_app38=-99 then 0.0 else cnt_top_app38 end as cnt_top_app38,
case when cnt_top_app40 is null or cnt_top_app40=-99 then 0.0 else cnt_top_app40 end as cnt_top_app40,
case when cnt_top_app43 is null or cnt_top_app43=-99 then 0.0 else cnt_top_app43 end as cnt_top_app43,
case when cnt_top_app308 is null or cnt_top_app308=-99 then 0.0 else cnt_top_app308 end as cnt_top_app308,
case when cnt_top_app234 is null or cnt_top_app234=-99 then 0.0 else cnt_top_app234 end as cnt_top_app234,
case when cnt_top_app120 is null or cnt_top_app120=-99 then 0.0 else cnt_top_app120 end as cnt_top_app120,
case when cnt_top_app386 is null or cnt_top_app386=-99 then 0.0 else cnt_top_app386 end as cnt_top_app386,
case when cnt_top_app350 is null or cnt_top_app350=-99 then 0.0 else cnt_top_app350 end as cnt_top_app350,
case when cnt_top_app61 is null or cnt_top_app61=-99 then 0.0 else cnt_top_app61 end as cnt_top_app61,
case when cnt_cate_l2_union_mf_app_cnt_edu is null or cnt_cate_l2_union_mf_app_cnt_edu=-99 then 1.0 else cnt_cate_l2_union_mf_app_cnt_edu end as cnt_cate_l2_union_mf_app_cnt_edu,
case when cnt_cate_l2_union_mf_app_cnt_female_high is null or cnt_cate_l2_union_mf_app_cnt_female_high=-99 then 1.0 else cnt_cate_l2_union_mf_app_cnt_female_high end as cnt_cate_l2_union_mf_app_cnt_female_high,
case when cnt_cate_l2_union_mf_cate_cnt_male_cnt is null or cnt_cate_l2_union_mf_cate_cnt_male_cnt=-99 then 4.0 else cnt_cate_l2_union_mf_cate_cnt_male_cnt end as cnt_cate_l2_union_mf_cate_cnt_male_cnt,
case when cnt_cate_l2_union_mf_cate_cnt_tgi_male_female is null or cnt_cate_l2_union_mf_cate_cnt_tgi_male_female=-99 then 1.25 else cnt_cate_l2_union_mf_cate_cnt_tgi_male_female end as cnt_cate_l2_union_mf_cate_cnt_tgi_male_female,
case when cnt_cate_l2_union_mf_cate_cnt_game is null or cnt_cate_l2_union_mf_cate_cnt_game=-99 then 0.0 else cnt_cate_l2_union_mf_cate_cnt_game end as cnt_cate_l2_union_mf_cate_cnt_game,
case when cnt_cate_l2_union_mf_cate_cnt_female_cnt is null or cnt_cate_l2_union_mf_cate_cnt_female_cnt=-99 then 4.0 else cnt_cate_l2_union_mf_cate_cnt_female_cnt end as cnt_cate_l2_union_mf_cate_cnt_female_cnt,
case when rt_cate_l1_cos_sim_index8 is null or rt_cate_l1_cos_sim_index8=-99 then 0.32140352770707864 else rt_cate_l1_cos_sim_index8 end as rt_cate_l1_cos_sim_index8,
case when rt_cate_l1_cos_sim_index18_female is null or rt_cate_l1_cos_sim_index18_female=-99 then 0.6377561051623984 else rt_cate_l1_cos_sim_index18_female end as rt_cate_l1_cos_sim_index18_female,
case when rt_cate_l1_cos_sim_index11_female is null or rt_cate_l1_cos_sim_index11_female=-99 then 0.11763755252124031 else rt_cate_l1_cos_sim_index11_female end as rt_cate_l1_cos_sim_index11_female,
case when rt_cate_l1_cos_sim_index8_female is null or rt_cate_l1_cos_sim_index8_female=-99 then 0.7554286679280852 else rt_cate_l1_cos_sim_index8_female end as rt_cate_l1_cos_sim_index8_female,
case when rt_cate_l1_cos_sim_index7_female is null or rt_cate_l1_cos_sim_index7_female=-99 then 0.5211732387907173 else rt_cate_l1_cos_sim_index7_female end as rt_cate_l1_cos_sim_index7_female,
case when rt_cate_l1_cos_sim_index10 is null or rt_cate_l1_cos_sim_index10=-99 then 0.041048680292000095 else rt_cate_l1_cos_sim_index10 end as rt_cate_l1_cos_sim_index10,
case when rt_cate_l1_cos_sim_index9_female is null or rt_cate_l1_cos_sim_index9_female=-99 then 0.963827038739326 else rt_cate_l1_cos_sim_index9_female end as rt_cate_l1_cos_sim_index9_female,
case when rt_cate_l1_cos_sim_index5_female is null or rt_cate_l1_cos_sim_index5_female=-99 then 0.7480724590221915 else rt_cate_l1_cos_sim_index5_female end as rt_cate_l1_cos_sim_index5_female,
case when rt_cate_l1_cos_sim_index12_female is null or rt_cate_l1_cos_sim_index12_female=-99 then 0.9327629592522364 else rt_cate_l1_cos_sim_index12_female end as rt_cate_l1_cos_sim_index12_female,
case when rt_cate_l1_cos_sim_index16 is null or rt_cate_l1_cos_sim_index16=-99 then 0.10290942933973517 else rt_cate_l1_cos_sim_index16 end as rt_cate_l1_cos_sim_index16,
case when rt_cate_l1_cos_sim_index19 is null or rt_cate_l1_cos_sim_index19=-99 then 0.3338120897273767 else rt_cate_l1_cos_sim_index19 end as rt_cate_l1_cos_sim_index19,
case when rt_cate_l1_cos_sim_index2_female is null or rt_cate_l1_cos_sim_index2_female=-99 then 0.8574862795165439 else rt_cate_l1_cos_sim_index2_female end as rt_cate_l1_cos_sim_index2_female,
case when rt_cate_l1_cos_sim_index12 is null or rt_cate_l1_cos_sim_index12=-99 then 0.5160457284011137 else rt_cate_l1_cos_sim_index12 end as rt_cate_l1_cos_sim_index12,
case when rt_cate_l1_cos_sim_index13_female is null or rt_cate_l1_cos_sim_index13_female=-99 then 0.30991349145333125 else rt_cate_l1_cos_sim_index13_female end as rt_cate_l1_cos_sim_index13_female,
case when rt_cate_l1_cos_sim_index19_female is null or rt_cate_l1_cos_sim_index19_female=-99 then 0.4723824428151058 else rt_cate_l1_cos_sim_index19_female end as rt_cate_l1_cos_sim_index19_female,
case when rt_cate_l1_cos_sim_index10_female is null or rt_cate_l1_cos_sim_index10_female=-99 then 0.8661424259598355 else rt_cate_l1_cos_sim_index10_female end as rt_cate_l1_cos_sim_index10_female,
case when rt_cate_l1_cos_sim_index15_female is null or rt_cate_l1_cos_sim_index15_female=-99 then 0.6169480960948865 else rt_cate_l1_cos_sim_index15_female end as rt_cate_l1_cos_sim_index15_female,
case when rt_cos_sim_tgi_male is null or rt_cos_sim_tgi_male=-99 then 0.3006459283743206 else rt_cos_sim_tgi_male end as rt_cos_sim_tgi_male,
case when rt_cos_sim_tgi_female_high is null or rt_cos_sim_tgi_female_high=-99 then 0.4496091380052474 else rt_cos_sim_tgi_female_high end as rt_cos_sim_tgi_female_high,
case when rt_cos_sim_tgi_male_high is null or rt_cos_sim_tgi_male_high=-99 then 0.2796995902543968 else rt_cos_sim_tgi_male_high end as rt_cos_sim_tgi_male_high,
case when rt_cos_sim_tgi_female is null or rt_cos_sim_tgi_female=-99 then 0.12751447874632987 else rt_cos_sim_tgi_female end as rt_cos_sim_tgi_female,
case when rt_topic11 is null or rt_topic11=-99 then 0.042339726595906034 else rt_topic11 end as rt_topic11,
case when rt_topic2 is null or rt_topic2=-99 then 0.054187669943264474 else rt_topic2 end as rt_topic2,
case when rt_topic17 is null or rt_topic17=-99 then 0.0474137005459179 else rt_topic17 end as rt_topic17,
case when rt_topic20 is null or rt_topic20=-99 then 0.04583673616093804 else rt_topic20 end as rt_topic20,
case when rt_topic16 is null or rt_topic16=-99 then 0.05404405863059646 else rt_topic16 end as rt_topic16,
case when rt_topic3 is null or rt_topic3=-99 then 0.06388204318614504 else rt_topic3 end as rt_topic3,
case when rt_topic19 is null or rt_topic19=-99 then 0.04291478900411375 else rt_topic19 end as rt_topic19,
case when rt_topic7 is null or rt_topic7=-99 then 0.04346331300039173 else rt_topic7 end as rt_topic7,
case when rt_topic14 is null or rt_topic14=-99 then 0.0433885972233648 else rt_topic14 end as rt_topic14,
case when rt_topic6 is null or rt_topic6=-99 then 0.04706187813979618 else rt_topic6 end as rt_topic6,
case when rt_cate_l2_cos_sim_index102 is null or rt_cate_l2_cos_sim_index102=-99 then 0.9612 else rt_cate_l2_cos_sim_index102 end as rt_cate_l2_cos_sim_index102,
case when rt_cate_l2_cos_sim_index103 is null or rt_cate_l2_cos_sim_index103=-99 then 0.9773 else rt_cate_l2_cos_sim_index103 end as rt_cate_l2_cos_sim_index103,
case when rt_cate_l2_cos_sim_index104 is null or rt_cate_l2_cos_sim_index104=-99 then 0.7478 else rt_cate_l2_cos_sim_index104 end as rt_cate_l2_cos_sim_index104,
case when rt_cate_l2_cos_sim_index110_female is null or rt_cate_l2_cos_sim_index110_female=-99 then 0.5284 else rt_cate_l2_cos_sim_index110_female end as rt_cate_l2_cos_sim_index110_female,
case when rt_cate_l2_cos_sim_index112_female is null or rt_cate_l2_cos_sim_index112_female=-99 then 0.8143 else rt_cate_l2_cos_sim_index112_female end as rt_cate_l2_cos_sim_index112_female,
case when rt_cate_l2_cos_sim_index115 is null or rt_cate_l2_cos_sim_index115=-99 then 0.9654 else rt_cate_l2_cos_sim_index115 end as rt_cate_l2_cos_sim_index115,
case when rt_cate_l2_cos_sim_index120_female is null or rt_cate_l2_cos_sim_index120_female=-99 then 0.856 else rt_cate_l2_cos_sim_index120_female end as rt_cate_l2_cos_sim_index120_female,
case when rt_cate_l2_cos_sim_index124 is null or rt_cate_l2_cos_sim_index124=-99 then 0.3452 else rt_cate_l2_cos_sim_index124 end as rt_cate_l2_cos_sim_index124,
case when rt_cate_l2_cos_sim_index126 is null or rt_cate_l2_cos_sim_index126=-99 then 0.4298 else rt_cate_l2_cos_sim_index126 end as rt_cate_l2_cos_sim_index126,
case when rt_cate_l2_cos_sim_index126_female is null or rt_cate_l2_cos_sim_index126_female=-99 then 0.7929 else rt_cate_l2_cos_sim_index126_female end as rt_cate_l2_cos_sim_index126_female,
case when rt_cate_l2_cos_sim_index128_female is null or rt_cate_l2_cos_sim_index128_female=-99 then 0.9941 else rt_cate_l2_cos_sim_index128_female end as rt_cate_l2_cos_sim_index128_female,
case when rt_cate_l2_cos_sim_index134 is null or rt_cate_l2_cos_sim_index134=-99 then 0.1276 else rt_cate_l2_cos_sim_index134 end as rt_cate_l2_cos_sim_index134,
case when rt_cate_l2_cos_sim_index137_female is null or rt_cate_l2_cos_sim_index137_female=-99 then 0.9763 else rt_cate_l2_cos_sim_index137_female end as rt_cate_l2_cos_sim_index137_female,
case when rt_cate_l2_cos_sim_index138_female is null or rt_cate_l2_cos_sim_index138_female=-99 then 0.4053 else rt_cate_l2_cos_sim_index138_female end as rt_cate_l2_cos_sim_index138_female,
case when rt_cate_l2_cos_sim_index14_female is null or rt_cate_l2_cos_sim_index14_female=-99 then 0.9785 else rt_cate_l2_cos_sim_index14_female end as rt_cate_l2_cos_sim_index14_female,
case when rt_cate_l2_cos_sim_index140_female is null or rt_cate_l2_cos_sim_index140_female=-99 then 0.8978 else rt_cate_l2_cos_sim_index140_female end as rt_cate_l2_cos_sim_index140_female,
case when rt_cate_l2_cos_sim_index141 is null or rt_cate_l2_cos_sim_index141=-99 then 0.5915 else rt_cate_l2_cos_sim_index141 end as rt_cate_l2_cos_sim_index141,
case when rt_cate_l2_cos_sim_index141_female is null or rt_cate_l2_cos_sim_index141_female=-99 then 0.57 else rt_cate_l2_cos_sim_index141_female end as rt_cate_l2_cos_sim_index141_female,
case when rt_cate_l2_cos_sim_index142_female is null or rt_cate_l2_cos_sim_index142_female=-99 then 0.7722 else rt_cate_l2_cos_sim_index142_female end as rt_cate_l2_cos_sim_index142_female,
case when rt_cate_l2_cos_sim_index145 is null or rt_cate_l2_cos_sim_index145=-99 then 0.6504 else rt_cate_l2_cos_sim_index145 end as rt_cate_l2_cos_sim_index145,
case when rt_cate_l2_cos_sim_index147 is null or rt_cate_l2_cos_sim_index147=-99 then 0.9888 else rt_cate_l2_cos_sim_index147 end as rt_cate_l2_cos_sim_index147,
case when rt_cate_l2_cos_sim_index15 is null or rt_cate_l2_cos_sim_index15=-99 then 0.1042 else rt_cate_l2_cos_sim_index15 end as rt_cate_l2_cos_sim_index15,
case when rt_cate_l2_cos_sim_index15_female is null or rt_cate_l2_cos_sim_index15_female=-99 then 0.8894 else rt_cate_l2_cos_sim_index15_female end as rt_cate_l2_cos_sim_index15_female,
case when rt_cate_l2_cos_sim_index150_female is null or rt_cate_l2_cos_sim_index150_female=-99 then 0.6769 else rt_cate_l2_cos_sim_index150_female end as rt_cate_l2_cos_sim_index150_female,
case when rt_cate_l2_cos_sim_index152_female is null or rt_cate_l2_cos_sim_index152_female=-99 then 0.9224 else rt_cate_l2_cos_sim_index152_female end as rt_cate_l2_cos_sim_index152_female,
case when rt_cate_l2_cos_sim_index155_female is null or rt_cate_l2_cos_sim_index155_female=-99 then 0.8599 else rt_cate_l2_cos_sim_index155_female end as rt_cate_l2_cos_sim_index155_female,
case when rt_cate_l2_cos_sim_index156_female is null or rt_cate_l2_cos_sim_index156_female=-99 then 0.9037 else rt_cate_l2_cos_sim_index156_female end as rt_cate_l2_cos_sim_index156_female,
case when rt_cate_l2_cos_sim_index157_female is null or rt_cate_l2_cos_sim_index157_female=-99 then 0.2075 else rt_cate_l2_cos_sim_index157_female end as rt_cate_l2_cos_sim_index157_female,
case when rt_cate_l2_cos_sim_index158_female is null or rt_cate_l2_cos_sim_index158_female=-99 then 0.9338 else rt_cate_l2_cos_sim_index158_female end as rt_cate_l2_cos_sim_index158_female,
case when rt_cate_l2_cos_sim_index159_female is null or rt_cate_l2_cos_sim_index159_female=-99 then 0.996 else rt_cate_l2_cos_sim_index159_female end as rt_cate_l2_cos_sim_index159_female,
case when rt_cate_l2_cos_sim_index162_female is null or rt_cate_l2_cos_sim_index162_female=-99 then 0.7374 else rt_cate_l2_cos_sim_index162_female end as rt_cate_l2_cos_sim_index162_female,
case when rt_cate_l2_cos_sim_index163 is null or rt_cate_l2_cos_sim_index163=-99 then 0.9341 else rt_cate_l2_cos_sim_index163 end as rt_cate_l2_cos_sim_index163,
case when rt_cate_l2_cos_sim_index165_female is null or rt_cate_l2_cos_sim_index165_female=-99 then 0.982 else rt_cate_l2_cos_sim_index165_female end as rt_cate_l2_cos_sim_index165_female,
case when rt_cate_l2_cos_sim_index171_female is null or rt_cate_l2_cos_sim_index171_female=-99 then 0.8538 else rt_cate_l2_cos_sim_index171_female end as rt_cate_l2_cos_sim_index171_female,
case when rt_cate_l2_cos_sim_index172 is null or rt_cate_l2_cos_sim_index172=-99 then 0.9498 else rt_cate_l2_cos_sim_index172 end as rt_cate_l2_cos_sim_index172,
case when rt_cate_l2_cos_sim_index176 is null or rt_cate_l2_cos_sim_index176=-99 then 0.5593 else rt_cate_l2_cos_sim_index176 end as rt_cate_l2_cos_sim_index176,
case when rt_cate_l2_cos_sim_index178 is null or rt_cate_l2_cos_sim_index178=-99 then 0.4528 else rt_cate_l2_cos_sim_index178 end as rt_cate_l2_cos_sim_index178,
case when rt_cate_l2_cos_sim_index180 is null or rt_cate_l2_cos_sim_index180=-99 then 0.8009999999999999 else rt_cate_l2_cos_sim_index180 end as rt_cate_l2_cos_sim_index180,
case when rt_cate_l2_cos_sim_index188_female is null or rt_cate_l2_cos_sim_index188_female=-99 then 0.9538 else rt_cate_l2_cos_sim_index188_female end as rt_cate_l2_cos_sim_index188_female,
case when rt_cate_l2_cos_sim_index19_female is null or rt_cate_l2_cos_sim_index19_female=-99 then 0.9807 else rt_cate_l2_cos_sim_index19_female end as rt_cate_l2_cos_sim_index19_female,
case when rt_cate_l2_cos_sim_index196 is null or rt_cate_l2_cos_sim_index196=-99 then 0.9998 else rt_cate_l2_cos_sim_index196 end as rt_cate_l2_cos_sim_index196,
case when rt_cate_l2_cos_sim_index201_female is null or rt_cate_l2_cos_sim_index201_female=-99 then 0.9915 else rt_cate_l2_cos_sim_index201_female end as rt_cate_l2_cos_sim_index201_female,
case when rt_cate_l2_cos_sim_index207_female is null or rt_cate_l2_cos_sim_index207_female=-99 then 0.6973 else rt_cate_l2_cos_sim_index207_female end as rt_cate_l2_cos_sim_index207_female,
case when rt_cate_l2_cos_sim_index209 is null or rt_cate_l2_cos_sim_index209=-99 then 0.8163 else rt_cate_l2_cos_sim_index209 end as rt_cate_l2_cos_sim_index209,
case when rt_cate_l2_cos_sim_index214 is null or rt_cate_l2_cos_sim_index214=-99 then 0.7739 else rt_cate_l2_cos_sim_index214 end as rt_cate_l2_cos_sim_index214,
case when rt_cate_l2_cos_sim_index25 is null or rt_cate_l2_cos_sim_index25=-99 then 0.9552 else rt_cate_l2_cos_sim_index25 end as rt_cate_l2_cos_sim_index25,
case when rt_cate_l2_cos_sim_index4 is null or rt_cate_l2_cos_sim_index4=-99 then 0.3619 else rt_cate_l2_cos_sim_index4 end as rt_cate_l2_cos_sim_index4,
case when rt_cate_l2_cos_sim_index40 is null or rt_cate_l2_cos_sim_index40=-99 then 0.9655 else rt_cate_l2_cos_sim_index40 end as rt_cate_l2_cos_sim_index40,
case when rt_cate_l2_cos_sim_index41 is null or rt_cate_l2_cos_sim_index41=-99 then 0.9434 else rt_cate_l2_cos_sim_index41 end as rt_cate_l2_cos_sim_index41,
case when rt_cate_l2_cos_sim_index42 is null or rt_cate_l2_cos_sim_index42=-99 then 0.9949 else rt_cate_l2_cos_sim_index42 end as rt_cate_l2_cos_sim_index42,
case when rt_cate_l2_cos_sim_index49 is null or rt_cate_l2_cos_sim_index49=-99 then 0.7694 else rt_cate_l2_cos_sim_index49 end as rt_cate_l2_cos_sim_index49,
case when rt_cate_l2_cos_sim_index5 is null or rt_cate_l2_cos_sim_index5=-99 then 0.6056 else rt_cate_l2_cos_sim_index5 end as rt_cate_l2_cos_sim_index5,
case when rt_cate_l2_cos_sim_index59 is null or rt_cate_l2_cos_sim_index59=-99 then 0.3471 else rt_cate_l2_cos_sim_index59 end as rt_cate_l2_cos_sim_index59,
case when rt_cate_l2_cos_sim_index6 is null or rt_cate_l2_cos_sim_index6=-99 then 0.7817 else rt_cate_l2_cos_sim_index6 end as rt_cate_l2_cos_sim_index6,
case when rt_cate_l2_cos_sim_index65_female is null or rt_cate_l2_cos_sim_index65_female=-99 then 0.9459 else rt_cate_l2_cos_sim_index65_female end as rt_cate_l2_cos_sim_index65_female,
case when rt_cate_l2_cos_sim_index66 is null or rt_cate_l2_cos_sim_index66=-99 then 0.2475 else rt_cate_l2_cos_sim_index66 end as rt_cate_l2_cos_sim_index66,
case when rt_cate_l2_cos_sim_index66_female is null or rt_cate_l2_cos_sim_index66_female=-99 then 0.2568 else rt_cate_l2_cos_sim_index66_female end as rt_cate_l2_cos_sim_index66_female,
case when rt_cate_l2_cos_sim_index7_female is null or rt_cate_l2_cos_sim_index7_female=-99 then 0.8727 else rt_cate_l2_cos_sim_index7_female end as rt_cate_l2_cos_sim_index7_female,
case when rt_cate_l2_cos_sim_index71 is null or rt_cate_l2_cos_sim_index71=-99 then 0.9993 else rt_cate_l2_cos_sim_index71 end as rt_cate_l2_cos_sim_index71,
case when rt_cate_l2_cos_sim_index80_female is null or rt_cate_l2_cos_sim_index80_female=-99 then 0.9512 else rt_cate_l2_cos_sim_index80_female end as rt_cate_l2_cos_sim_index80_female,
case when rt_cate_l2_cos_sim_index81 is null or rt_cate_l2_cos_sim_index81=-99 then 0.9263 else rt_cate_l2_cos_sim_index81 end as rt_cate_l2_cos_sim_index81,
case when rt_cate_l2_cos_sim_index86 is null or rt_cate_l2_cos_sim_index86=-99 then 0.5452 else rt_cate_l2_cos_sim_index86 end as rt_cate_l2_cos_sim_index86,
case when rt_cate_l2_cos_sim_index86_female is null or rt_cate_l2_cos_sim_index86_female=-99 then 0.5124 else rt_cate_l2_cos_sim_index86_female end as rt_cate_l2_cos_sim_index86_female,
case when rt_cate_l2_cos_sim_index87 is null or rt_cate_l2_cos_sim_index87=-99 then 0.7321 else rt_cate_l2_cos_sim_index87 end as rt_cate_l2_cos_sim_index87,
case when rt_cate_l2_cos_sim_index88 is null or rt_cate_l2_cos_sim_index88=-99 then 0.5836 else rt_cate_l2_cos_sim_index88 end as rt_cate_l2_cos_sim_index88,
case when rt_cate_l2_cos_sim_index88_female is null or rt_cate_l2_cos_sim_index88_female=-99 then 0.4698 else rt_cate_l2_cos_sim_index88_female end as rt_cate_l2_cos_sim_index88_female,
case when rt_cate_l2_cos_sim_index91_female is null or rt_cate_l2_cos_sim_index91_female=-99 then 0.9172 else rt_cate_l2_cos_sim_index91_female end as rt_cate_l2_cos_sim_index91_female,
case when rt_cate_l2_cos_sim_index92_female is null or rt_cate_l2_cos_sim_index92_female=-99 then 0.7734 else rt_cate_l2_cos_sim_index92_female end as rt_cate_l2_cos_sim_index92_female,
case when rt_cate_l2_cos_sim_index94 is null or rt_cate_l2_cos_sim_index94=-99 then 0.4239 else rt_cate_l2_cos_sim_index94 end as rt_cate_l2_cos_sim_index94,
case when rt_cate_l2_cos_sim_index94_female is null or rt_cate_l2_cos_sim_index94_female=-99 then 0.5317 else rt_cate_l2_cos_sim_index94_female end as rt_cate_l2_cos_sim_index94_female,
case when rt_cate_l2_cos_sim_index96_female is null or rt_cate_l2_cos_sim_index96_female=-99 then 0.9586 else rt_cate_l2_cos_sim_index96_female end as rt_cate_l2_cos_sim_index96_female,
case when rt_cate_mf_rt_avg_cate11_avg_tgi is null or rt_cate_mf_rt_avg_cate11_avg_tgi=-99 then 1.5291114533642618 when rt_cate_mf_rt_avg_cate11_avg_tgi=-1 then 0.7701666893974383 else rt_cate_mf_rt_avg_cate11_avg_tgi end as rt_cate_mf_rt_avg_cate11_avg_tgi,
case when rt_cate_mf_rt_avg_cate12_avg_tgi is null or rt_cate_mf_rt_avg_cate12_avg_tgi=-99 then 0.9467326288073904 when rt_cate_mf_rt_avg_cate12_avg_tgi=-1 then 0.9467326288073904 else rt_cate_mf_rt_avg_cate12_avg_tgi end as rt_cate_mf_rt_avg_cate12_avg_tgi,
case when rt_cate_mf_rt_avg_cate12_male_female is null or rt_cate_mf_rt_avg_cate12_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate12_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate12_male_female end as rt_cate_mf_rt_avg_cate12_male_female,
case when rt_cate_mf_rt_avg_cate14_avg_tgi is null or rt_cate_mf_rt_avg_cate14_avg_tgi=-99 then 1.4344420005634977 when rt_cate_mf_rt_avg_cate14_avg_tgi=-1 then 1.4344420005634977 else rt_cate_mf_rt_avg_cate14_avg_tgi end as rt_cate_mf_rt_avg_cate14_avg_tgi,
case when rt_cate_mf_rt_avg_cate14_male_female is null or rt_cate_mf_rt_avg_cate14_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate14_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate14_male_female end as rt_cate_mf_rt_avg_cate14_male_female,
case when rt_cate_mf_rt_avg_cate15_avg_tgi is null or rt_cate_mf_rt_avg_cate15_avg_tgi=-99 then 1.360888475119594 when rt_cate_mf_rt_avg_cate15_avg_tgi=-1 then 1.360888475119594 else rt_cate_mf_rt_avg_cate15_avg_tgi end as rt_cate_mf_rt_avg_cate15_avg_tgi,
case when rt_cate_mf_rt_avg_cate15_male_female is null or rt_cate_mf_rt_avg_cate15_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate15_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate15_male_female end as rt_cate_mf_rt_avg_cate15_male_female,
case when rt_cate_mf_rt_avg_cate16_avg_tgi is null or rt_cate_mf_rt_avg_cate16_avg_tgi=-99 then 1.1671047404345936 when rt_cate_mf_rt_avg_cate16_avg_tgi=-1 then 1.1671047404345936 else rt_cate_mf_rt_avg_cate16_avg_tgi end as rt_cate_mf_rt_avg_cate16_avg_tgi,
case when rt_cate_mf_rt_avg_cate16_male_female is null or rt_cate_mf_rt_avg_cate16_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate16_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate16_male_female end as rt_cate_mf_rt_avg_cate16_male_female,
case when rt_cate_mf_rt_avg_cate17_avg_tgi is null or rt_cate_mf_rt_avg_cate17_avg_tgi=-99 then 1.3534299265411434 when rt_cate_mf_rt_avg_cate17_avg_tgi=-1 then 1.3534299265411434 else rt_cate_mf_rt_avg_cate17_avg_tgi end as rt_cate_mf_rt_avg_cate17_avg_tgi,
case when rt_cate_mf_rt_avg_cate17_male_female is null then -99 else rt_cate_mf_rt_avg_cate17_male_female end as rt_cate_mf_rt_avg_cate17_male_female,
case when rt_cate_mf_rt_avg_cate18_avg_tgi is null or rt_cate_mf_rt_avg_cate18_avg_tgi=-99 then 1.5931713084466954 when rt_cate_mf_rt_avg_cate18_avg_tgi=-1 then 1.5931713084466954 else rt_cate_mf_rt_avg_cate18_avg_tgi end as rt_cate_mf_rt_avg_cate18_avg_tgi,
case when rt_cate_mf_rt_avg_cate19_avg_tgi is null or rt_cate_mf_rt_avg_cate19_avg_tgi=-99 then 1.1435625298250098 when rt_cate_mf_rt_avg_cate19_avg_tgi=-1 then 1.1435625298250098 else rt_cate_mf_rt_avg_cate19_avg_tgi end as rt_cate_mf_rt_avg_cate19_avg_tgi,
case when rt_cate_mf_rt_avg_cate19_male_female is null or rt_cate_mf_rt_avg_cate19_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate19_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate19_male_female end as rt_cate_mf_rt_avg_cate19_male_female,
case when rt_cate_mf_rt_avg_cate2_avg_tgi is null or rt_cate_mf_rt_avg_cate2_avg_tgi=-99 then 1.0642362768827414 when rt_cate_mf_rt_avg_cate2_avg_tgi=-1 then 1.0642362768827414 else rt_cate_mf_rt_avg_cate2_avg_tgi end as rt_cate_mf_rt_avg_cate2_avg_tgi,
case when rt_cate_mf_rt_avg_cate2_male_female is null or rt_cate_mf_rt_avg_cate2_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate2_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate2_male_female end as rt_cate_mf_rt_avg_cate2_male_female,
case when rt_cate_mf_rt_avg_cate20_avg_tgi is null or rt_cate_mf_rt_avg_cate20_avg_tgi=-99 then 1.3368675981001537 when rt_cate_mf_rt_avg_cate20_avg_tgi=-1 then 1.3368675981001537 else rt_cate_mf_rt_avg_cate20_avg_tgi end as rt_cate_mf_rt_avg_cate20_avg_tgi,
case when rt_cate_mf_rt_avg_cate20_male_female is null or rt_cate_mf_rt_avg_cate20_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate20_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate20_male_female end as rt_cate_mf_rt_avg_cate20_male_female,
case when rt_cate_mf_rt_avg_cate21_avg_tgi is null or rt_cate_mf_rt_avg_cate21_avg_tgi=-99 then 0.9029571946477432 when rt_cate_mf_rt_avg_cate21_avg_tgi=-1 then 0.9029571946477432 else rt_cate_mf_rt_avg_cate21_avg_tgi end as rt_cate_mf_rt_avg_cate21_avg_tgi,
case when rt_cate_mf_rt_avg_cate21_male_female is null or rt_cate_mf_rt_avg_cate21_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate21_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate21_male_female end as rt_cate_mf_rt_avg_cate21_male_female,
case when rt_cate_mf_rt_avg_cate23_male_female is null or rt_cate_mf_rt_avg_cate23_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate23_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate23_male_female end as rt_cate_mf_rt_avg_cate23_male_female,
case when rt_cate_mf_rt_avg_cate24_avg_tgi is null or rt_cate_mf_rt_avg_cate24_avg_tgi=-99 then 1.5806877141858882 when rt_cate_mf_rt_avg_cate24_avg_tgi=-1 then 1.5806877141858882 else rt_cate_mf_rt_avg_cate24_avg_tgi end as rt_cate_mf_rt_avg_cate24_avg_tgi,
case when rt_cate_mf_rt_avg_cate25_avg_tgi is null or rt_cate_mf_rt_avg_cate25_avg_tgi=-99 then 1.816432098886533 when rt_cate_mf_rt_avg_cate25_avg_tgi=-1 then 1.816432098886533 else rt_cate_mf_rt_avg_cate25_avg_tgi end as rt_cate_mf_rt_avg_cate25_avg_tgi,
case when rt_cate_mf_rt_avg_cate25_male_female is null or rt_cate_mf_rt_avg_cate25_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate25_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate25_male_female end as rt_cate_mf_rt_avg_cate25_male_female,
case when rt_cate_mf_rt_avg_cate27_avg_tgi is null or rt_cate_mf_rt_avg_cate27_avg_tgi=-99 then 1.8277895792603025 when rt_cate_mf_rt_avg_cate27_avg_tgi=-1 then 1.8277895792603025 else rt_cate_mf_rt_avg_cate27_avg_tgi end as rt_cate_mf_rt_avg_cate27_avg_tgi,
case when rt_cate_mf_rt_avg_cate29_avg_tgi is null or rt_cate_mf_rt_avg_cate29_avg_tgi=-99 then 0.9090209588788516 when rt_cate_mf_rt_avg_cate29_avg_tgi=-1 then 0.9090209588788516 else rt_cate_mf_rt_avg_cate29_avg_tgi end as rt_cate_mf_rt_avg_cate29_avg_tgi,
case when rt_cate_mf_rt_avg_cate29_male_female is null or rt_cate_mf_rt_avg_cate29_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate29_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate29_male_female end as rt_cate_mf_rt_avg_cate29_male_female,
case when rt_cate_mf_rt_avg_cate3_avg_tgi is null or rt_cate_mf_rt_avg_cate3_avg_tgi=-99 then 1.0299662505002245 when rt_cate_mf_rt_avg_cate3_avg_tgi=-1 then 1.0299662505002245 else rt_cate_mf_rt_avg_cate3_avg_tgi end as rt_cate_mf_rt_avg_cate3_avg_tgi,
case when rt_cate_mf_rt_avg_cate3_male_female is null or rt_cate_mf_rt_avg_cate3_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate3_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate3_male_female end as rt_cate_mf_rt_avg_cate3_male_female,
case when rt_cate_mf_rt_avg_cate30_avg_tgi is null or rt_cate_mf_rt_avg_cate30_avg_tgi=-99 then 1.410229779338038 when rt_cate_mf_rt_avg_cate30_avg_tgi=-1 then 1.410229779338038 else rt_cate_mf_rt_avg_cate30_avg_tgi end as rt_cate_mf_rt_avg_cate30_avg_tgi,
case when rt_cate_mf_rt_avg_cate30_male_female is null or rt_cate_mf_rt_avg_cate30_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate30_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate30_male_female end as rt_cate_mf_rt_avg_cate30_male_female,
case when rt_cate_mf_rt_avg_cate31_avg_tgi is null or rt_cate_mf_rt_avg_cate31_avg_tgi=-99 then 1.5341557892429032 when rt_cate_mf_rt_avg_cate31_avg_tgi=-1 then 1.5341557892429032 else rt_cate_mf_rt_avg_cate31_avg_tgi end as rt_cate_mf_rt_avg_cate31_avg_tgi,
case when rt_cate_mf_rt_avg_cate32_avg_tgi is null or rt_cate_mf_rt_avg_cate32_avg_tgi=-99 then 0.7657071689432162 when rt_cate_mf_rt_avg_cate32_avg_tgi=-1 then 0.7657071689432162 else rt_cate_mf_rt_avg_cate32_avg_tgi end as rt_cate_mf_rt_avg_cate32_avg_tgi,
case when rt_cate_mf_rt_avg_cate32_male_female is null or rt_cate_mf_rt_avg_cate32_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate32_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate32_male_female end as rt_cate_mf_rt_avg_cate32_male_female,
case when rt_cate_mf_rt_avg_cate33_avg_tgi is null or rt_cate_mf_rt_avg_cate33_avg_tgi=-99 then 0.7252434372981701 when rt_cate_mf_rt_avg_cate33_avg_tgi=-1 then 0.7252434372981701 else rt_cate_mf_rt_avg_cate33_avg_tgi end as rt_cate_mf_rt_avg_cate33_avg_tgi,
case when rt_cate_mf_rt_avg_cate33_male_female is null then -99 else rt_cate_mf_rt_avg_cate33_male_female end as rt_cate_mf_rt_avg_cate33_male_female,
case when rt_cate_mf_rt_avg_cate34_avg_tgi is null or rt_cate_mf_rt_avg_cate34_avg_tgi=-99 then 0.3623100852011586 when rt_cate_mf_rt_avg_cate34_avg_tgi=-1 then 0.3623100852011586 else rt_cate_mf_rt_avg_cate34_avg_tgi end as rt_cate_mf_rt_avg_cate34_avg_tgi,
case when rt_cate_mf_rt_avg_cate34_male_female is null then -99 else rt_cate_mf_rt_avg_cate34_male_female end as rt_cate_mf_rt_avg_cate34_male_female,
case when rt_cate_mf_rt_avg_cate35_avg_tgi is null or rt_cate_mf_rt_avg_cate35_avg_tgi=-99 then 0.7067435464975538 when rt_cate_mf_rt_avg_cate35_avg_tgi=-1 then 0.7067435464975538 else rt_cate_mf_rt_avg_cate35_avg_tgi end as rt_cate_mf_rt_avg_cate35_avg_tgi,
case when rt_cate_mf_rt_avg_cate35_male_female is null then -99 else rt_cate_mf_rt_avg_cate35_male_female end as rt_cate_mf_rt_avg_cate35_male_female,
case when rt_cate_mf_rt_avg_cate36_avg_tgi is null or rt_cate_mf_rt_avg_cate36_avg_tgi=-99 then 0.4526117847743935 when rt_cate_mf_rt_avg_cate36_avg_tgi=-1 then 0.4526117847743935 else rt_cate_mf_rt_avg_cate36_avg_tgi end as rt_cate_mf_rt_avg_cate36_avg_tgi,
case when rt_cate_mf_rt_avg_cate36_male_female is null then -99 else rt_cate_mf_rt_avg_cate36_male_female end as rt_cate_mf_rt_avg_cate36_male_female,
case when rt_cate_mf_rt_avg_cate37_avg_tgi is null or rt_cate_mf_rt_avg_cate37_avg_tgi=-99 then 0.3530642621958495 when rt_cate_mf_rt_avg_cate37_avg_tgi=-1 then 0.3530642621958495 else rt_cate_mf_rt_avg_cate37_avg_tgi end as rt_cate_mf_rt_avg_cate37_avg_tgi,
case when rt_cate_mf_rt_avg_cate37_male_female is null then -99 else rt_cate_mf_rt_avg_cate37_male_female end as rt_cate_mf_rt_avg_cate37_male_female,
case when rt_cate_mf_rt_avg_cate38_avg_tgi is null or rt_cate_mf_rt_avg_cate38_avg_tgi=-99 then 0.6962865777743836 when rt_cate_mf_rt_avg_cate38_avg_tgi=-1 then 0.6962865777743836 else rt_cate_mf_rt_avg_cate38_avg_tgi end as rt_cate_mf_rt_avg_cate38_avg_tgi,
case when rt_cate_mf_rt_avg_cate38_male_female is null or rt_cate_mf_rt_avg_cate38_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate38_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate38_male_female end as rt_cate_mf_rt_avg_cate38_male_female,
case when rt_cate_mf_rt_avg_cate4_avg_tgi is null or rt_cate_mf_rt_avg_cate4_avg_tgi=-99 then 0.9990596795982386 when rt_cate_mf_rt_avg_cate4_avg_tgi=-1 then 0.9990596795982386 else rt_cate_mf_rt_avg_cate4_avg_tgi end as rt_cate_mf_rt_avg_cate4_avg_tgi,
case when rt_cate_mf_rt_avg_cate4_male_female is null or rt_cate_mf_rt_avg_cate4_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate4_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate4_male_female end as rt_cate_mf_rt_avg_cate4_male_female,
case when rt_cate_mf_rt_avg_cate40_avg_tgi is null or rt_cate_mf_rt_avg_cate40_avg_tgi=-99 then 1.0072621168069853 when rt_cate_mf_rt_avg_cate40_avg_tgi=-1 then 1.0072621168069853 else rt_cate_mf_rt_avg_cate40_avg_tgi end as rt_cate_mf_rt_avg_cate40_avg_tgi,
case when rt_cate_mf_rt_avg_cate42_male_female is null or rt_cate_mf_rt_avg_cate42_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate42_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate42_male_female end as rt_cate_mf_rt_avg_cate42_male_female,
case when rt_cate_mf_rt_avg_cate44_avg_tgi is null or rt_cate_mf_rt_avg_cate44_avg_tgi=-99 then 0.8643408805091407 when rt_cate_mf_rt_avg_cate44_avg_tgi=-1 then 0.8643408805091407 else rt_cate_mf_rt_avg_cate44_avg_tgi end as rt_cate_mf_rt_avg_cate44_avg_tgi,
case when rt_cate_mf_rt_avg_cate44_male_female is null or rt_cate_mf_rt_avg_cate44_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate44_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate44_male_female end as rt_cate_mf_rt_avg_cate44_male_female,
case when rt_cate_mf_rt_avg_cate45_avg_tgi is null or rt_cate_mf_rt_avg_cate45_avg_tgi=-99 then 0.23976790297106065 when rt_cate_mf_rt_avg_cate45_avg_tgi=-1 then 0.23976790297106065 else rt_cate_mf_rt_avg_cate45_avg_tgi end as rt_cate_mf_rt_avg_cate45_avg_tgi,
case when rt_cate_mf_rt_avg_cate45_male_female is null or rt_cate_mf_rt_avg_cate45_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate45_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate45_male_female end as rt_cate_mf_rt_avg_cate45_male_female,
case when rt_cate_mf_rt_avg_cate46_avg_tgi is null or rt_cate_mf_rt_avg_cate46_avg_tgi=-99 then 1.307151900312957 when rt_cate_mf_rt_avg_cate46_avg_tgi=-1 then 1.307151900312957 else rt_cate_mf_rt_avg_cate46_avg_tgi end as rt_cate_mf_rt_avg_cate46_avg_tgi,
case when rt_cate_mf_rt_avg_cate46_male_female is null or rt_cate_mf_rt_avg_cate46_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate46_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate46_male_female end as rt_cate_mf_rt_avg_cate46_male_female,
case when rt_cate_mf_rt_avg_cate48_avg_tgi is null or rt_cate_mf_rt_avg_cate48_avg_tgi=-99 then 0.8063271280981537 when rt_cate_mf_rt_avg_cate48_avg_tgi=-1 then 0.8063271280981537 else rt_cate_mf_rt_avg_cate48_avg_tgi end as rt_cate_mf_rt_avg_cate48_avg_tgi,
case when rt_cate_mf_rt_avg_cate48_male_female is null or rt_cate_mf_rt_avg_cate48_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate48_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate48_male_female end as rt_cate_mf_rt_avg_cate48_male_female,
case when rt_cate_mf_rt_avg_cate49_avg_tgi is null or rt_cate_mf_rt_avg_cate49_avg_tgi=-99 then 0.2644683980662961 when rt_cate_mf_rt_avg_cate49_avg_tgi=-1 then 0.2644683980662961 else rt_cate_mf_rt_avg_cate49_avg_tgi end as rt_cate_mf_rt_avg_cate49_avg_tgi,
case when rt_cate_mf_rt_avg_cate49_male_female is null or rt_cate_mf_rt_avg_cate49_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate49_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate49_male_female end as rt_cate_mf_rt_avg_cate49_male_female,
case when rt_cate_mf_rt_avg_cate5_avg_tgi is null or rt_cate_mf_rt_avg_cate5_avg_tgi=-99 then 0.3118321216388816 when rt_cate_mf_rt_avg_cate5_avg_tgi=-1 then 0.3118321216388816 else rt_cate_mf_rt_avg_cate5_avg_tgi end as rt_cate_mf_rt_avg_cate5_avg_tgi,
case when rt_cate_mf_rt_avg_cate5_male_female is null then -99 else rt_cate_mf_rt_avg_cate5_male_female end as rt_cate_mf_rt_avg_cate5_male_female,
case when rt_cate_mf_rt_avg_cate50_avg_tgi is null or rt_cate_mf_rt_avg_cate50_avg_tgi=-99 then 0.4798009806472682 when rt_cate_mf_rt_avg_cate50_avg_tgi=-1 then 0.4798009806472682 else rt_cate_mf_rt_avg_cate50_avg_tgi end as rt_cate_mf_rt_avg_cate50_avg_tgi,
case when rt_cate_mf_rt_avg_cate50_male_female is null or rt_cate_mf_rt_avg_cate50_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate50_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate50_male_female end as rt_cate_mf_rt_avg_cate50_male_female,
case when rt_cate_mf_rt_avg_cate6_avg_tgi is null or rt_cate_mf_rt_avg_cate6_avg_tgi=-99 then 0.9557367456263008 when rt_cate_mf_rt_avg_cate6_avg_tgi=-1 then 0.9557367456263008 else rt_cate_mf_rt_avg_cate6_avg_tgi end as rt_cate_mf_rt_avg_cate6_avg_tgi,
case when rt_cate_mf_rt_avg_cate7_avg_tgi is null or rt_cate_mf_rt_avg_cate7_avg_tgi=-99 then 1.3581558187993308 when rt_cate_mf_rt_avg_cate7_avg_tgi=-1 then 1.3581558187993308 else rt_cate_mf_rt_avg_cate7_avg_tgi end as rt_cate_mf_rt_avg_cate7_avg_tgi,
case when rt_cate_mf_rt_avg_cate7_male_female is null or rt_cate_mf_rt_avg_cate7_male_female=-99 then 0.0 when rt_cate_mf_rt_avg_cate7_male_female=-1 then 0.0 else rt_cate_mf_rt_avg_cate7_male_female end as rt_cate_mf_rt_avg_cate7_male_female,
case when rt_cate_mf_rt_avg_cate8_avg_tgi is null or rt_cate_mf_rt_avg_cate8_avg_tgi=-99 then 0.9692258059559774 when rt_cate_mf_rt_avg_cate8_avg_tgi=-1 then 0.9692258059559774 else rt_cate_mf_rt_avg_cate8_avg_tgi end as rt_cate_mf_rt_avg_cate8_avg_tgi,
case when rt_cate_mf_rt_avg_cate8_male_female is null or rt_cate_mf_rt_avg_cate8_male_female=-99 then 2.0 when rt_cate_mf_rt_avg_cate8_male_female=-1 then 2.0 else rt_cate_mf_rt_avg_cate8_male_female end as rt_cate_mf_rt_avg_cate8_male_female
from (
select device, index15 cnt_cate_l1_index15,
index8 cnt_cate_l1_index8,
index19 cnt_cate_l1_index19,
index18 cnt_cate_l1_index18,
index12 cnt_cate_l1_index12,
index13 cnt_cate_l1_index13,
index5 cnt_cate_l1_index5,
index16 cnt_cate_l1_index16
from $gender_feature_v2_part1 where day='$day') t1
left join (
select device, index102 cnt_cate_l2_index102,
index91 cnt_cate_l2_index91,
index10 cnt_cate_l2_index10,
index165 cnt_cate_l2_index165,
index214 cnt_cate_l2_index214,
index124 cnt_cate_l2_index124,
index162 cnt_cate_l2_index162,
index178 cnt_cate_l2_index178,
index140 cnt_cate_l2_index140,
index4 cnt_cate_l2_index4,
index196 cnt_cate_l2_index196,
index209 cnt_cate_l2_index209,
index96 cnt_cate_l2_index96,
index158 cnt_cate_l2_index158,
index41 cnt_cate_l2_index41,
index14 cnt_cate_l2_index14,
index20 cnt_cate_l2_index20,
index188 cnt_cate_l2_index188,
index86 cnt_cate_l2_index86,
index92 cnt_cate_l2_index92,
index201 cnt_cate_l2_index201,
index137 cnt_cate_l2_index137
from $gender_feature_v2_part2 where day='$day') t2 on t1.device=t2.device
left join (
select device, index19 rt_cate_l1_index19,
index11 rt_cate_l1_index11,
index18 rt_cate_l1_index18,
index12 rt_cate_l1_index12,
index13 rt_cate_l1_index13,
index5 rt_cate_l1_index5
from $gender_feature_v2_part3 where day='$day'
) t3 on t1.device=t3.device
left join (
select device, index44 rt_cate_l2_index44,
index102 rt_cate_l2_index102,
index42 rt_cate_l2_index42,
index156 rt_cate_l2_index156,
index7 rt_cate_l2_index7,
index57 rt_cate_l2_index57,
index91 rt_cate_l2_index91,
index10 rt_cate_l2_index10,
index103 rt_cate_l2_index103,
index115 rt_cate_l2_index115,
index16 rt_cate_l2_index16,
index52 rt_cate_l2_index52,
index6 rt_cate_l2_index6,
index214 rt_cate_l2_index214,
index124 rt_cate_l2_index124,
index152 rt_cate_l2_index152,
index178 rt_cate_l2_index178,
index140 rt_cate_l2_index140,
index4 rt_cate_l2_index4,
index71 rt_cate_l2_index71,
index128 rt_cate_l2_index128,
index45 rt_cate_l2_index45,
index126 rt_cate_l2_index126,
index196 rt_cate_l2_index196,
index209 rt_cate_l2_index209,
index94 rt_cate_l2_index94,
index87 rt_cate_l2_index87,
index41 rt_cate_l2_index41,
index88 rt_cate_l2_index88,
index14 rt_cate_l2_index14,
index147 rt_cate_l2_index147,
index93 rt_cate_l2_index93,
index60 rt_cate_l2_index60,
index188 rt_cate_l2_index188,
index86 rt_cate_l2_index86,
index59 rt_cate_l2_index59,
index111 rt_cate_l2_index111,
index92 rt_cate_l2_index92,
index65 rt_cate_l2_index65,
index201 rt_cate_l2_index201,
index137 rt_cate_l2_index137,
index159 rt_cate_l2_index159
from $gender_feature_v2_part4 where day='$day'
) t4 on t1.device=t4.device
left join (
select device, tgi_male cnt_tgi5_tgi_male,
tgi_female cnt_tgi5_tgi_female,
tgi_female_high cnt_tgi5_tgi_female_high,
tgi_male_high cnt_tgi5_tgi_male_high
from $gender_feature_v2_part5 where day='$day'
) t5 on t1.device=t5.device
left join (
select device, tgi_male rt_tgi5_tgi_male,
tgi_female rt_tgi5_tgi_female,
tgi_female_high rt_tgi5_tgi_female_high,
tgi_male_high rt_tgi5_tgi_male_high,
tgi_normal rt_tgi5_tgi_normal
from $gender_feature_v2_part6 where day='$day'
) t6 on t1.device=t6.device
left join (
select device, tgi_male_female rt_tgi_male_female
from $gender_feature_v2_part7 where day='$day'
) t7 on t1.device=t7.device
left join (
select device, avg_tgi rt_avg_tgi
from $gender_feature_v2_part8 where day='$day'
) t8 on t1.device=t8.device
left join (
select device,app56 cnt_top_app56,
app81 cnt_top_app81,
app121 cnt_top_app121,
app187 cnt_top_app187,
app247 cnt_top_app247,
app287 cnt_top_app287,
app180 cnt_top_app180,
app33 cnt_top_app33,
app38 cnt_top_app38,
app40 cnt_top_app40,
app43 cnt_top_app43,
app308 cnt_top_app308,
app234 cnt_top_app234,
app120 cnt_top_app120,
app386 cnt_top_app386,
app350 cnt_top_app350,
app61 cnt_top_app61
from $gender_feature_v2_part9 where day='$day'
) t9 on t1.device=t9.device
left join (
select device, cate11_avg_tgi rt_cate_mf_rt_avg_cate11_avg_tgi,
cate12_avg_tgi rt_cate_mf_rt_avg_cate12_avg_tgi,
cate12_male_female rt_cate_mf_rt_avg_cate12_male_female,
cate14_avg_tgi rt_cate_mf_rt_avg_cate14_avg_tgi,
cate14_male_female rt_cate_mf_rt_avg_cate14_male_female,
cate15_avg_tgi rt_cate_mf_rt_avg_cate15_avg_tgi,
cate15_male_female rt_cate_mf_rt_avg_cate15_male_female,
cate16_avg_tgi rt_cate_mf_rt_avg_cate16_avg_tgi,
cate16_male_female rt_cate_mf_rt_avg_cate16_male_female,
cate17_avg_tgi rt_cate_mf_rt_avg_cate17_avg_tgi,
cate17_male_female rt_cate_mf_rt_avg_cate17_male_female,
cate18_avg_tgi rt_cate_mf_rt_avg_cate18_avg_tgi,
cate19_avg_tgi rt_cate_mf_rt_avg_cate19_avg_tgi,
cate19_male_female rt_cate_mf_rt_avg_cate19_male_female,
cate2_avg_tgi rt_cate_mf_rt_avg_cate2_avg_tgi,
cate2_male_female rt_cate_mf_rt_avg_cate2_male_female,
cate20_avg_tgi rt_cate_mf_rt_avg_cate20_avg_tgi,
cate20_male_female rt_cate_mf_rt_avg_cate20_male_female,
cate21_avg_tgi rt_cate_mf_rt_avg_cate21_avg_tgi,
cate21_male_female rt_cate_mf_rt_avg_cate21_male_female,
cate23_male_female rt_cate_mf_rt_avg_cate23_male_female,
cate24_avg_tgi rt_cate_mf_rt_avg_cate24_avg_tgi,
cate25_avg_tgi rt_cate_mf_rt_avg_cate25_avg_tgi,
cate25_male_female rt_cate_mf_rt_avg_cate25_male_female,
cate27_avg_tgi rt_cate_mf_rt_avg_cate27_avg_tgi,
cate29_avg_tgi rt_cate_mf_rt_avg_cate29_avg_tgi,
cate29_male_female rt_cate_mf_rt_avg_cate29_male_female,
cate3_avg_tgi rt_cate_mf_rt_avg_cate3_avg_tgi,
cate3_male_female rt_cate_mf_rt_avg_cate3_male_female,
cate30_avg_tgi rt_cate_mf_rt_avg_cate30_avg_tgi,
cate30_male_female rt_cate_mf_rt_avg_cate30_male_female,
cate31_avg_tgi rt_cate_mf_rt_avg_cate31_avg_tgi,
cate32_avg_tgi rt_cate_mf_rt_avg_cate32_avg_tgi,
cate32_male_female rt_cate_mf_rt_avg_cate32_male_female,
cate33_avg_tgi rt_cate_mf_rt_avg_cate33_avg_tgi,
cate33_male_female rt_cate_mf_rt_avg_cate33_male_female,
cate34_avg_tgi rt_cate_mf_rt_avg_cate34_avg_tgi,
cate34_male_female rt_cate_mf_rt_avg_cate34_male_female,
cate35_avg_tgi rt_cate_mf_rt_avg_cate35_avg_tgi,
cate35_male_female rt_cate_mf_rt_avg_cate35_male_female,
cate36_avg_tgi rt_cate_mf_rt_avg_cate36_avg_tgi,
cate36_male_female rt_cate_mf_rt_avg_cate36_male_female,
cate37_avg_tgi rt_cate_mf_rt_avg_cate37_avg_tgi,
cate37_male_female rt_cate_mf_rt_avg_cate37_male_female,
cate38_avg_tgi rt_cate_mf_rt_avg_cate38_avg_tgi,
cate38_male_female rt_cate_mf_rt_avg_cate38_male_female,
cate4_avg_tgi rt_cate_mf_rt_avg_cate4_avg_tgi,
cate4_male_female rt_cate_mf_rt_avg_cate4_male_female,
cate40_avg_tgi rt_cate_mf_rt_avg_cate40_avg_tgi,
cate42_male_female rt_cate_mf_rt_avg_cate42_male_female,
cate44_avg_tgi rt_cate_mf_rt_avg_cate44_avg_tgi,
cate44_male_female rt_cate_mf_rt_avg_cate44_male_female,
cate45_avg_tgi rt_cate_mf_rt_avg_cate45_avg_tgi,
cate45_male_female rt_cate_mf_rt_avg_cate45_male_female,
cate46_avg_tgi rt_cate_mf_rt_avg_cate46_avg_tgi,
cate46_male_female rt_cate_mf_rt_avg_cate46_male_female,
cate48_avg_tgi rt_cate_mf_rt_avg_cate48_avg_tgi,
cate48_male_female rt_cate_mf_rt_avg_cate48_male_female,
cate49_avg_tgi rt_cate_mf_rt_avg_cate49_avg_tgi,
cate49_male_female rt_cate_mf_rt_avg_cate49_male_female,
cate5_avg_tgi rt_cate_mf_rt_avg_cate5_avg_tgi,
cate5_male_female rt_cate_mf_rt_avg_cate5_male_female,
cate50_avg_tgi rt_cate_mf_rt_avg_cate50_avg_tgi,
cate50_male_female rt_cate_mf_rt_avg_cate50_male_female,
cate6_avg_tgi rt_cate_mf_rt_avg_cate6_avg_tgi,
cate7_avg_tgi rt_cate_mf_rt_avg_cate7_avg_tgi,
cate7_male_female rt_cate_mf_rt_avg_cate7_male_female,
cate8_avg_tgi rt_cate_mf_rt_avg_cate8_avg_tgi,
cate8_male_female rt_cate_mf_rt_avg_cate8_male_female
from $gender_feature_v2_part13 where day='$day'
) t13 on t1.device=t13.device
left join (
select device, edu cnt_cate_l2_union_mf_app_cnt_edu,
female_high cnt_cate_l2_union_mf_app_cnt_female_high
from $gender_feature_v2_part14 where day='$day'
) t14 on t1.device=t14.device
left join (
select device, male_cnt cnt_cate_l2_union_mf_cate_cnt_male_cnt,
tgi_male_female cnt_cate_l2_union_mf_cate_cnt_tgi_male_female,
game cnt_cate_l2_union_mf_cate_cnt_game,
female_cnt cnt_cate_l2_union_mf_cate_cnt_female_cnt
from $gender_feature_v2_part15 where day='$day'
) t15 on t1.device=t15.device
left join (
select device, index8 rt_cate_l1_cos_sim_index8,
index18_female rt_cate_l1_cos_sim_index18_female,
index11_female rt_cate_l1_cos_sim_index11_female,
index8_female rt_cate_l1_cos_sim_index8_female,
index7_female rt_cate_l1_cos_sim_index7_female,
index10 rt_cate_l1_cos_sim_index10,
index9_female rt_cate_l1_cos_sim_index9_female,
index5_female rt_cate_l1_cos_sim_index5_female,
index12_female rt_cate_l1_cos_sim_index12_female,
index16 rt_cate_l1_cos_sim_index16,
index19 rt_cate_l1_cos_sim_index19,
index2_female rt_cate_l1_cos_sim_index2_female,
index12 rt_cate_l1_cos_sim_index12,
index13_female rt_cate_l1_cos_sim_index13_female,
index19_female rt_cate_l1_cos_sim_index19_female,
index10_female rt_cate_l1_cos_sim_index10_female,
index15_female rt_cate_l1_cos_sim_index15_female
from $gender_feature_v2_part16 where day='$day'
) t16 on t1.device=t16.device
left join (
select device, index102 rt_cate_l2_cos_sim_index102,
index103 rt_cate_l2_cos_sim_index103,
index104 rt_cate_l2_cos_sim_index104,
index110_female rt_cate_l2_cos_sim_index110_female,
index112_female rt_cate_l2_cos_sim_index112_female,
index115 rt_cate_l2_cos_sim_index115,
index120_female rt_cate_l2_cos_sim_index120_female,
index124 rt_cate_l2_cos_sim_index124,
index126 rt_cate_l2_cos_sim_index126,
index126_female rt_cate_l2_cos_sim_index126_female,
index128_female rt_cate_l2_cos_sim_index128_female,
index134 rt_cate_l2_cos_sim_index134,
index137_female rt_cate_l2_cos_sim_index137_female,
index138_female rt_cate_l2_cos_sim_index138_female,
index14_female rt_cate_l2_cos_sim_index14_female,
index140_female rt_cate_l2_cos_sim_index140_female,
index141 rt_cate_l2_cos_sim_index141,
index141_female rt_cate_l2_cos_sim_index141_female,
index142_female rt_cate_l2_cos_sim_index142_female,
index145 rt_cate_l2_cos_sim_index145,
index147 rt_cate_l2_cos_sim_index147,
index15 rt_cate_l2_cos_sim_index15,
index15_female rt_cate_l2_cos_sim_index15_female,
index150_female rt_cate_l2_cos_sim_index150_female,
index152_female rt_cate_l2_cos_sim_index152_female,
index155_female rt_cate_l2_cos_sim_index155_female,
index156_female rt_cate_l2_cos_sim_index156_female,
index157_female rt_cate_l2_cos_sim_index157_female,
index158_female rt_cate_l2_cos_sim_index158_female,
index159_female rt_cate_l2_cos_sim_index159_female,
index162_female rt_cate_l2_cos_sim_index162_female,
index163 rt_cate_l2_cos_sim_index163,
index165_female rt_cate_l2_cos_sim_index165_female,
index171_female rt_cate_l2_cos_sim_index171_female,
index172 rt_cate_l2_cos_sim_index172,
index176 rt_cate_l2_cos_sim_index176,
index178 rt_cate_l2_cos_sim_index178,
index180 rt_cate_l2_cos_sim_index180,
index188_female rt_cate_l2_cos_sim_index188_female,
index19_female rt_cate_l2_cos_sim_index19_female,
index196 rt_cate_l2_cos_sim_index196,
index201_female rt_cate_l2_cos_sim_index201_female,
index207_female rt_cate_l2_cos_sim_index207_female,
index209 rt_cate_l2_cos_sim_index209,
index214 rt_cate_l2_cos_sim_index214,
index25 rt_cate_l2_cos_sim_index25,
index4 rt_cate_l2_cos_sim_index4,
index40 rt_cate_l2_cos_sim_index40,
index41 rt_cate_l2_cos_sim_index41,
index42 rt_cate_l2_cos_sim_index42,
index49 rt_cate_l2_cos_sim_index49,
index5 rt_cate_l2_cos_sim_index5,
index59 rt_cate_l2_cos_sim_index59,
index6 rt_cate_l2_cos_sim_index6,
index65_female rt_cate_l2_cos_sim_index65_female,
index66 rt_cate_l2_cos_sim_index66,
index66_female rt_cate_l2_cos_sim_index66_female,
index7_female rt_cate_l2_cos_sim_index7_female,
index71 rt_cate_l2_cos_sim_index71,
index80_female rt_cate_l2_cos_sim_index80_female,
index81 rt_cate_l2_cos_sim_index81,
index86 rt_cate_l2_cos_sim_index86,
index86_female rt_cate_l2_cos_sim_index86_female,
index87 rt_cate_l2_cos_sim_index87,
index88 rt_cate_l2_cos_sim_index88,
index88_female rt_cate_l2_cos_sim_index88_female,
index91_female rt_cate_l2_cos_sim_index91_female,
index92_female rt_cate_l2_cos_sim_index92_female,
index94 rt_cate_l2_cos_sim_index94,
index94_female rt_cate_l2_cos_sim_index94_female,
index96_female rt_cate_l2_cos_sim_index96_female
from $gender_feature_v2_part17 where day='$day'
) t17 on t1.device=t17.device
left join (
select device, cos_sim_tgi_male rt_cos_sim_tgi_male,
cos_sim_tgi_female_high rt_cos_sim_tgi_female_high,
cos_sim_tgi_male_high rt_cos_sim_tgi_male_high,
cos_sim_tgi_female rt_cos_sim_tgi_female
from $gender_feature_v2_part18 where day='$day'
) t18 on t1.device=t18.device
left join (
select device, topic11 rt_topic11,
topic2 rt_topic2,
topic17 rt_topic17,
topic20 rt_topic20,
topic16 rt_topic16,
topic3 rt_topic3,
topic19 rt_topic19,
topic7 rt_topic7,
topic14 rt_topic14,
topic6 rt_topic6
from $gender_feature_v2_part19 where day='$day'
) t19 on t1.device=t19.device
;
"